var E=Object.defineProperty;var I=(a,t,e)=>t in a?E(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var r=(a,t,e)=>(I(a,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();var l=(a=>(a[a.RECTANGLE=0]="RECTANGLE",a[a.CIRCLE=1]="CIRCLE",a[a.TRIANGLE=2]="TRIANGLE",a[a.LINE=3]="LINE",a))(l||{});class u{}r(u,"Screen",{Width:1024,Height:768});class w{constructor(t){r(this,"context");this.context=t}clear(){this.context.clearRect(0,0,u.Screen.Width,u.Screen.Height)}redraw(t){this.clear(),t.forEach(e=>{this.draw(e)})}drawImage(t,e,n){this.context.drawImage(t,e,n)}draw(t){switch(this.context.fillStyle=t.fillColor,this.context.strokeStyle=t.pathColor,this.context.lineWidth=t.lineWidth,t.type){case l.RECTANGLE:this.drawRect(t);break;case l.CIRCLE:this.drawCircle(t);break;case l.LINE:this.drawLine(t);break;case l.TRIANGLE:this.drawTriangle(t);break}}drawRect(t){const e=Math.abs(t.x2-t.x1),n=Math.abs(t.y2-t.y1),i=t.x1<=t.x2?t.x1:t.x2,s=t.y1<=t.y2?t.y1:t.y2;this.context.fillRect(i,s,e,n),t.lineWidth>0&&this.context.strokeRect(i,s,e,n)}drawCircle(t){const e=t.x1-t.x2,n=t.y1-t.y2,i=Math.sqrt(e*e+n*n)/2,s=t.x2+e/2,o=t.y2+n/2;this.context.beginPath(),this.context.arc(s,o,i,0,2*Math.PI,!1),this.context.fill(),t.lineWidth>0&&this.context.stroke()}drawTriangle(t){const e=(t.x1+t.x2)/2,n=t.y1;this.context.beginPath(),this.context.moveTo(e,n),this.context.lineTo(t.x1,t.y2),this.context.lineTo(t.x2,t.y2),this.context.closePath(),this.context.fillStyle=t.fillColor,this.context.fill(),t.lineWidth>0&&(this.context.strokeStyle=t.pathColor,this.context.lineWidth=t.lineWidth,this.context.stroke())}drawLine(t){this.context.beginPath(),this.context.lineWidth=t.lineWidth,this.context.moveTo(t.x2,t.y2),this.context.lineTo(t.x1||t.x2,t.y1||t.y2),this.context.stroke()}}function y(a){return typeof a!="string"?!1:!!(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(a)||/^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)$/.test(a)||/^#[0-9A-Fa-f]{6}$/.test(a))}class c{static isPointInsideObject(t,e,n){switch(n.type){case l.RECTANGLE:return c.isPointInsideRectangle(t,e,n);case l.CIRCLE:return c.isPointInsideCircle(t,e,n);case l.TRIANGLE:return c.isPointInsideTriangle(t,e,n);case l.LINE:return c.isPointInsideLine(t,e,n);default:return!1}}static isPointInsideRectangle(t,e,n){const{x1:i,y1:s,x2:o,y2:h}=n;return t>=i&&t<=o&&e>=s&&e<=h}static isPointInsideCircle(t,e,n){const i=n.x1-n.x2,s=n.y1-n.y2,o=Math.sqrt(i*i+s*s)/2,h=n.x2+i/2,d=n.y2+s/2;return Math.sqrt(Math.pow(t-h,2)+Math.pow(e-d,2))<=o}static area(t,e,n,i,s,o){return Math.abs((t*(i-o)+n*(o-e)+s*(e-i))/2)}static isPointInsideTriangle(t,e,n){const i=n.x1,s=n.y2,o=(n.x1+n.x2)/2,h=n.y1,d=n.x2,p=n.y2;let g=c.area(i,s,o,h,d,p),m=c.area(t,e,o,h,d,p),x=c.area(i,s,t,e,d,p),L=c.area(i,s,o,h,t,e);return g==m+x+L}static isPointInsideLine(t,e,n){const{x1:i,y1:s,x2:o,y2:h}=n,d=Math.sqrt(Math.pow(t-i,2)+Math.pow(e-s,2)),p=Math.sqrt(Math.pow(t-o,2)+Math.pow(e-h,2)),g=Math.sqrt(Math.pow(o-i,2)+Math.pow(h-s,2)),m=.1;return d+p>=g-m&&d+p<=g+m}}const f=class{constructor(t,e){r(this,"objects");r(this,"selectedObject");r(this,"renderer");r(this,"parametersList");r(this,"panelTitle");this.objects=t,this.renderer=e,this.selectedObject=null,this.parametersList=document.getElementById("parameters-list"),this.panelTitle=document.getElementById("panel-title")}handleSelect(t){t.preventDefault();const{offsetX:e,offsetY:n}=t;this.selectedObject=this.getTopmostObject(e,n),this.selectedObject&&this.showProperties()}showProperties(){this.selectedObject!==null&&(this.panelTitle.innerText=`${l[this.selectedObject.type]}`,this.parametersList.innerHTML="",f.parametersList.forEach(t=>this.addProperty(t)),this.addDeleteButton())}addProperty(t){if(t==="type")return;const e=document.createElement("div");e.className="parameter";const n=document.createElement("span");n.className="parameter-name",n.innerText=this.getParameterName(t);const i=document.createElement("input");i.type=this.getParameterType(t),i.min="0",i.className="parameter-value",i.value=this.selectedObject[t].toString(),i.addEventListener("input",s=>this.updateParameter(s,t)),e.appendChild(n),e.appendChild(i),this.parametersList.appendChild(e)}addDeleteButton(){const t=document.createElement("button");t.innerText="Delete",t.addEventListener("click",this.deleteObject.bind(this)),this.parametersList.appendChild(t)}deleteObject(){if(this.selectedObject===null)return;const t=this.objects.indexOf(this.selectedObject);t>-1&&(this.objects.splice(t,1),this.renderer.redraw(this.objects),this.parametersList.innerHTML="",this.panelTitle.innerText="OBJECT")}getTopmostObject(t,e){for(let n=this.objects.length-1;n>=0;n--){const i=this.objects[n];if(n!==0&&c.isPointInsideObject(t,e,i))return i}return null}getParameterName(t){switch(t){case"x1":return"X1";case"x2":return"X2";case"y1":return"Y1";case"y2":return"Y2";case"lineWidth":return"Line Width";case"pathColor":return"Path Color";case"fillColor":return"Fill Color";default:return t}}getParameterType(t){let e="string";return typeof this.selectedObject[t]=="number"&&(e="number"),y(this.selectedObject[t])&&(e="color"),e}updateParameter(t,e){this.selectedObject[e]=t.target.value,this.renderer.redraw(this.objects)}};let C=f;r(C,"parametersList",["x1","y1","x2","y2","lineWidth","pathColor","fillColor"]);class v{constructor(t,e,n,i,s,o){r(this,"canvas");r(this,"renderer");r(this,"settings");r(this,"settingsPanel");r(this,"propertiesPanel");r(this,"objects");r(this,"drawingObject");this.objects=o,this.canvas=t,this.settings=n,this.renderer=e,this.propertiesPanel=i,this.settingsPanel=s,this.settingsPanel.onBackgroundColorUpdate=this.updateBackground.bind(this),this.canvas.addEventListener("pointerdown",this.startDrawing.bind(this)),this.canvas.addEventListener("pointerup",this.stopDrawing.bind(this)),this.canvas.addEventListener("pointermove",this.onDrawing.bind(this)),this.canvas.addEventListener("contextmenu",this.propertiesPanel.handleSelect.bind(this.propertiesPanel)),this.initBackground()}initBackground(){this.hasBackground()||(this.objects.unshift({type:l.RECTANGLE,fillColor:this.settings.backgroundColor,pathColor:"#000000",x1:0,lineWidth:0,y2:u.Screen.Height,x2:u.Screen.Width,y1:0}),this.renderer.redraw(this.objects))}isBackground(t){return t.x1===0&&t.y1===0&&t.x2===u.Screen.Width&&t.y2===u.Screen.Height}hasBackground(){return this.objects.length>0&&this.isBackground(this.objects[0])}updateBackground(){this.hasBackground()&&(this.objects[0].fillColor=this.settings.backgroundColor,this.renderer.redraw(this.objects))}startDrawing(t){if(t.preventDefault(),t.button!==0)return;const{offsetX:e,offsetY:n}=t;this.drawingObject={type:this.settings.type,x1:e,y1:n,fillColor:this.settings.fillColor,pathColor:this.settings.pathColor,lineWidth:this.settings.lineWidth}}stopDrawing(t){if(t.preventDefault(),t.button!==0)return;const{offsetX:e,offsetY:n}=t;this.drawingObject={x2:e,y2:n,...this.drawingObject},this.objects.push(this.drawingObject),this.drawingObject=null,this.renderer.redraw(this.objects)}onDrawing(t){if(t.preventDefault(),t.button!==-1)return;const{offsetX:e,offsetY:n}=t;this.renderer.redraw(this.objects);const i={x2:e,y2:n,...this.drawingObject};this.renderer.draw(i)}}class b{constructor(t){r(this,"onBackgroundColorUpdate",()=>{});r(this,"settings");r(this,"settingsPanelContainer");r(this,"parametersList");r(this,"shapeSelect");r(this,"lineWidthInput");r(this,"fillColorInput");r(this,"pathColorInput");r(this,"backgroundColorInput");this.settings=t,this.init()}init(){this.settingsPanelContainer=document.getElementById("settings-panel-container"),this.initParametersList(),this.initShapeSelector(),this.initLineWidthInput(),this.initFillColorInput(),this.initPathColorInput(),this.initBackgroundColorInput(),this.settingsPanelContainer.appendChild(this.parametersList),this.initListeners()}initParametersList(){this.parametersList=document.createElement("div"),this.parametersList.classList.add("parameters-list")}initShapeSelector(){const t=document.createElement("label");t.textContent="Shape",this.shapeSelect=document.createElement("select"),this.shapeSelect.id="shape-select";const e=document.createElement("option");e.value=l.RECTANGLE.toString(),e.textContent="Rectangle",this.shapeSelect.appendChild(e);const n=document.createElement("option");n.value=l.CIRCLE.toString(),n.textContent="Circle",this.shapeSelect.appendChild(n);const i=document.createElement("option");i.value=l.TRIANGLE.toString(),i.textContent="Triangle",this.shapeSelect.appendChild(i);const s=document.createElement("option");s.value=l.LINE.toString(),s.textContent="Line",this.shapeSelect.appendChild(s),this.parametersList.appendChild(t),this.parametersList.appendChild(this.shapeSelect)}initLineWidthInput(){const t=document.createElement("label");t.textContent="Line Width";const e=document.createElement("span");e.textContent="10",e.style.fontWeight="bold",this.lineWidthInput=document.createElement("input"),this.lineWidthInput.type="range",this.lineWidthInput.min="0",this.lineWidthInput.max="100",this.lineWidthInput.value=this.settings.lineWidth.toString(),this.lineWidthInput.oninput=()=>e.textContent=this.lineWidthInput.value.toString(),e.textContent=this.lineWidthInput.value.toString(),this.parametersList.appendChild(t),this.parametersList.appendChild(this.lineWidthInput),this.parametersList.appendChild(e)}initFillColorInput(){const t=document.createElement("label");t.textContent="Fill Color: ",this.fillColorInput=document.createElement("input"),this.fillColorInput.type="color",this.fillColorInput.value=this.settings.fillColor.toString(),this.parametersList.appendChild(t),this.parametersList.appendChild(this.fillColorInput)}initPathColorInput(){const t=document.createElement("label");t.textContent="Path Color: ",this.pathColorInput=document.createElement("input"),this.pathColorInput.type="color",this.pathColorInput.value=this.settings.pathColor.toString(),this.parametersList.appendChild(t),this.parametersList.appendChild(this.pathColorInput)}initBackgroundColorInput(){const t=document.createElement("label");t.textContent="Background Color: ",this.backgroundColorInput=document.createElement("input"),this.backgroundColorInput.type="color",this.backgroundColorInput.value=this.settings.backgroundColor.toString(),this.parametersList.appendChild(t),this.parametersList.appendChild(this.backgroundColorInput)}initListeners(){this.shapeSelect.addEventListener("change",t=>{this.settings.type=Number(t.target.value)}),this.lineWidthInput.addEventListener("input",t=>{this.settings.lineWidth=Number(t.target.value)}),this.fillColorInput.addEventListener("input",t=>{this.settings.fillColor=t.target.value}),this.pathColorInput.addEventListener("input",t=>{this.settings.pathColor=t.target.value}),this.backgroundColorInput.addEventListener("input",t=>{this.settings.backgroundColor=t.target.value,this.onBackgroundColorUpdate()})}}class P{constructor(){r(this,"onClearClick",()=>{});r(this,"onSaveClick",()=>{});r(this,"onLoad",()=>{});r(this,"onExportClick",()=>{});r(this,"clearBtn");r(this,"saveBtn");r(this,"loadBtn");r(this,"exportBtn");r(this,"fileInput");this.clearBtn=document.getElementById("clear"),this.saveBtn=document.getElementById("save"),this.loadBtn=document.getElementById("load"),this.exportBtn=document.getElementById("export"),this.fileInput=document.getElementById("file-input"),this.init()}init(){this.clearBtn.addEventListener("click",()=>this.onClearClick()),this.saveBtn.addEventListener("click",()=>this.onSaveClick()),this.loadBtn.addEventListener("click",()=>{this.fileInput.click()}),this.exportBtn.addEventListener("click",()=>this.onExportClick()),this.fileInput.addEventListener("change",t=>{const n=t.target.files[0],i=new FileReader;i.onload=s=>{const o=s.target.result;this.onLoad(o)},i.readAsText(n)})}}class k{constructor(){r(this,"objects");r(this,"canvas");r(this,"renderer");r(this,"settings");r(this,"settingsPanel");r(this,"propertiesPanel");r(this,"graphicEditor");r(this,"controlsPanel");this.objects=[],this.canvas=document.getElementById("canvas"),this.renderer=new w(this.canvas.getContext("2d")),this.settings={type:l.RECTANGLE,fillColor:"#42f563",pathColor:"#000000",lineWidth:2,backgroundColor:"#fafafa"},this.settingsPanel=new b(this.settings),this.propertiesPanel=new C(this.objects,this.renderer),this.controlsPanel=new P,this.graphicEditor=new v(this.canvas,this.renderer,this.settings,this.propertiesPanel,this.settingsPanel,this.objects),this.init()}init(){this.controlsPanel.onClearClick=this.clear.bind(this),this.controlsPanel.onSaveClick=this.saveData.bind(this),this.controlsPanel.onExportClick=this.saveImage.bind(this),this.controlsPanel.onLoad=this.loadData.bind(this)}saveImage(){const t=this.canvas.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.download="image.png",e.click()}saveData(){const t=JSON.stringify(this.objects),e="data.json",n=new Blob([t],{type:"application/json"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,e);else{const i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=e,s.click(),setTimeout(()=>{URL.revokeObjectURL(i)},0)}}loadData(t){this.objects.splice(0),this.objects.push(...JSON.parse(t)),console.log(this.objects),this.renderer.redraw(this.objects)}clear(){this.objects.splice(1),this.renderer.redraw(this.objects)}}window.addEventListener("load",S);function S(){new k}
